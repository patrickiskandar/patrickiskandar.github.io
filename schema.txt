CREATE TABLE patients
(
    patientid          SERIAL PRIMARY KEY,
    name               TEXT NOT NULL,
    email_address      TEXT,
    phone_num          TEXT,
    address            TEXT,
    age                INT,
    status             TEXT,
    bname              TEXT REFERENCES borough
);

CREATE TABLE persons
(
patientid          SERIAL PRIMARY KEY,
name               TEXT NOT NULL,
email_address      TEXT,
phone_num          TEXT,
address            TEXT,
age                INT,
bname              TEXT REFERENCES borough
);

CREATE TABLE healthcare_professionals
(
    hid              SERIAL PRIMARY KEY,
    name             TEXT NOT NULL,
    designation      TEXT NOT NULL,
    phone_num        INT NOT NULL
);

CREATE TABLE drugs
(
    name           TEXT PRIMARY KEY,
    date_time      TIMESTAMP NOT NULL,
    ATC_code       VARCHAR(7) NOT NULL,
    dosage         INT NOT NULL,
    hid            SERIAL REFERENCES healthcare_professionals,
    patientid      SERIAL REFERENCES patients
);


CREATE TABLE observations
(
    freetext    TEXT NOT NULL,
    date_time   TIMESTAMP NOT NULL,
    hid         SERIAL REFERENCES healthcare_professionals,
    patientid   SERIAL REFERENCES patients,
    PRIMARY KEY (hid, date_time)
);

CREATE TABLE borough
(
    bname       TEXT PRIMARY KEY,
    population  INT NOT NULL
);

CREATE TABLE interact
(
    patientid   SERIAL,
    personid    SERIAL,
    PRIMARY KEY (patientid, personid),
    FOREIGN KEY (patientid) REFERENCES patients,
    FOREIGN KEY (personid) REFERENCES persons
);


CREATE TABLE administer
(
    hid         SERIAL,
    patientid   SERIAL,
    name        TEXT,
    date_time   TIMESTAMP,
    PRIMARY KEY (hid, patientid, name),
    FOREIGN KEY (patientid) REFERENCES patients,
    FOREIGN KEY (hid) REFERENCES healthcare_professionals,
    FOREIGN KEY (name) REFERENCES drugs
);

CREATE TABLE tests
(
    date_time     TIMESTAMP,
    results       TEXT,
    hid           SERIAL,
    personid      SERIAL,
    PRIMARY KEY (hid, personid),
    FOREIGN KEY (hid) REFERENCES healthcare_professionals,
    FOREIGN KEY (personid) REFERENCES persons
);
